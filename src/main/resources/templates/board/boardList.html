<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
        xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>

<th:block layout:fragment="script">
    <script th:inline="javascript">
        $(document).ready(function (){
            $("#searchBtn").on("click", function (e){
                e.preventDefault();
                page(0);
            });
        });

        function page(page){
            var searchDataType = $("#searchDataType").val();
            var searchBy = $("#searchBy").val();
            var searchQuery = $("#searchQuery").val();

            location.href= '/'+page+'?searchBy=' + searchBy + "&searchQuery=" + searchQuery;
        }
    </script>
</th:block>
<head>
    <meta charset="UTF-8">
    <title>BoardList</title>
</head>
<body>
<div layout:fragment="content">
    <div>
        <h3>게시판 목록</h3>
    </div>
    <div class="content">
        <p th:align="right">
            <a >글쓰기</a>
        </p>
        <table class="table text-center align-center">
            <colgroup>
                <col style="width: 7.5%;"/>
                <col style="width: auto;"/>
                <col style="width: 10%;"/>
                <col style="width: 15%"/>
            </colgroup>
            <thead>
            <tr>
                <th scope="col">번호</th>
                <th scope="col">제목</th>
                <th scope="col">작성자</th>
                <th scope="col">날짜</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="board : ${boards}">
                <td th:text="${board.bno}"></td>
                <td>
                    <a th:href="@{/board/{bno}(bno=${board.bno})}" th:text="${board.title}"></a>
                </td>
                <td th:text="${board.writer.uid}"></td>
                <td th:text="${board.regTime}"></td>
            </tr>
            </tbody>
        </table>

        <section>
        <!--페이지 네이션-->
            <nav aria-label="Page navigation example" th:with="start=${(boards.number/maxPage) * maxPage + 1}, end=(${(boards.totalPages == 0) ? 1 : (start+(maxPage -1) < boards.totalPages ? start + (maxPage - 1) : boards.totalPages)})">
                <ul class="pagination justify-content-center">
                    <li class="page-item" th:classappend="${boards.first} ? 'disabled'"><a th:onclick="'javascript:page(' + ${boards.number - 1}')'" th:inline="text" class="page-link">&laquo;</a></li>
                    <li class="page-item" th:each="page:${#numbers.sequence(start,end)}" th:classappend="${boards.number eq page -1}?'active':''"><a th:onclick="'javascript:page(' + ${page -1}+')'" th:inline="text" class="page-link">[[${page}]]</a></li>
<!--                    <li class="page-item"><a class="page-link" href="#">1</a></li>-->
<!--                    <li class="page-item active" aria-current="page"><a class="page-link" href="#">2</a></li>-->
<!--                    <li class="page-item"><a class="page-link" href="#">3</a></li>-->
                    <li class="page-item" th:classappend="${boards.last}?'disabled'"><a th:onclick="'javascript:page(' + ${boards.number + 1} + ')'" class="page-link">&raquo;</a></li>
                </ul>
            </nav>
        </section>
        <section>
        <!--검색-->
            <div class="input-group justify-content-end">
                <form method="get" id="d-flex" role="search">
                    <div class="input-group" th:object="${searchDto}">
                        <select title="검색 유형 선택" th:field="*{searchBy}">
                            <option value="">전체 검색</option>
                            <option value="title">제목</option>
                            <option value="content">본문</option>
                            <option value="writer">작성자</option>
                            <option value="hashtag">해시태그</option>
                        </select>
                        <input th:field="*{searchQuery}" class="form-control me-2" type="search" name="keyword" placeholder="키워드를 입력해주세요." title="키워드 입력" />
                        <button type="submit" class="btn btn-outline-success"><i class="fas fa-search"></i>
                        <span id="searchBtn" class="skip_info">검색</span></button>
                    </div>
                </form>
            </div>
        </section>
    </div>
</div>
</body>
</html>